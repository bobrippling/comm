#include <stdio.h>#include <getopt.h>#include <string.h>#include <stdlib.h>#include <string.h>#include <locale.h>#include <errno.h>#include <setjmp.h>#include "settings.h"#include "ui/ui.h"#define DEFAULT_PORT	7331#define DEFAULT_NAME	"Noob"#define LOCALE				"en_GB.UTF-8"static void usage(char *);#define USAGE() do { usage(*argv); return 1; } while(0)struct settings global_settings;jmp_buf allocerr;int main(int argc, char **argv){	int ret = 0;	setlocale(LC_ALL, LOCALE);	if(setjmp(allocerr)){		ui_message(UI_ERROR, "Out of memory!");		return 1;	}	switch(argc){		case 2:			if(strcmp(argv[1], "--help"))				fprintf(stderr, "Unrecognised arg: \"%s\"\n", argv[1]);		default:			USAGE();		case 1:			break;	}	global_settings.name   = DEFAULT_NAME;	global_settings.port   = DEFAULT_PORT;	global_settings.daemon = 1;	ui_main();	return ret;}static void usage(char *progname){	fprintf(stderr, "Usage: %s [options] host\n", progname);	fputs(" -l:	Listen/Host mode\n"			  " -p: Port\n"			  " -u:	Username\n", stderr);}